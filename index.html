<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶á-‡¶Æ‡ßå‡¶ú‡¶æ - ‡¶Æ‡ßå‡¶ú‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans Bengali', sans-serif;
        }
        .hero-bg {
            background-image: url('https://images.unsplash.com/photo-1597072689227-8882273fc85b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            min-height: 500px;
            background-color: #4a90e2;
        }
        .search-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .file-info {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 10px;
            margin-top: 10px;
            border-left: 4px solid #4CAF50;
        }
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .auth-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        .whatsapp-icon {
            font-size: 2rem;
            color: #25D366;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gradient-to-r from-green-100 via-blue-100 to-purple-100">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white sticky top-0 z-50 shadow-lg">
        <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="text-3xl font-bold text-yellow-300">
                <a href="index.html">‡¶á-‡¶Æ‡ßå‡¶ú‡¶æ</a>
            </div>
            <ul class="flex space-x-6 text-lg">
                <li><a href="index.html" class="hover:text-yellow-200">‡¶π‡ßã‡¶Æ</a></li>
                <li><a href="services.html" class="hover:text-yellow-200">‡¶∏‡ßá‡¶¨‡¶æ</a></li>
                <li><a href="contact.html" class="hover:text-yellow-200">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero-bg flex items-center justify-center text-center text-white py-20">
        <div class="container mx-auto px-4">
            <h1 class="text-4xl md:text-5xl font-bold mb-6 text-orange-300">‡¶Æ‡ßå‡¶ú‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</h1>
            <p class="text-lg mb-8 text-green-200">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶ú‡ßá‡¶≤‡¶æ, ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶ì ‡¶Æ‡ßå‡¶ú‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ PDF ‡¶è‡¶¨‡¶Ç JPG ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡•§</p>
            <div class="search-box max-w-2xl mx-auto">
                <form id="searchForm" class="flex flex-col md:flex-row gap-4">
                    <select id="district" class="w-full px-4 py-2 rounded-md text-black bg-white border border-green-300">
                        <option value="">‡¶ú‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                        <option value="dhaka">‡¶¢‡¶æ‡¶ï‡¶æ</option>
                        <option value="chittagong">‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ</option>
                    </select>
                    <select id="upazila" class="w-full px-4 py-2 rounded-md text-black bg-white border border-green-300">
                        <option value="">‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
                        <option value="savar">‡¶∏‡¶æ‡¶≠‡¶æ‡¶∞</option>
                        <option value="mirpur">‡¶Æ‡¶ø‡¶∞‡¶™‡ßÅ‡¶∞</option>
                    </select>
                    <input type="text" id="mouza" placeholder="‡¶Æ‡ßå‡¶ú‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" class="w-full px-4 py-2 rounded-md text-black bg-white border border-green-300">
                    <button type="button" onclick="searchMap()" class="bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white px-6 py-2 rounded-md">‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="container mx-auto px-4 py-16">
        <h2 class="text-3xl font-bold text-center mb-12 text-indigo-700">‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßá‡¶¨‡¶æ‡¶∏‡¶Æ‡ßÇ‡¶π</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="bg-gradient-to-br from-blue-100 to-cyan-100 p-6 rounded-lg shadow-md text-center hover:bg-gradient-to-tl hover:from-blue-200 hover:to-cyan-200 transition duration-300">
                <img src="https://via.placeholder.com/50" alt="Map Icon" class="mx-auto mb-4">
                <h3 class="text-xl font-semibold mb-4 text-blue-700">‡¶â‡¶ö‡ßç‡¶ö ‡¶Æ‡¶æ‡¶®‡ßá‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™</h3>
                <p class="text-gray-700">‡¶â‡¶ö‡ßç‡¶ö ‡¶∞‡ßá‡¶ú‡ßã‡¶≤‡¶ø‡¶â‡¶∂‡¶®‡ßá‡¶∞ ‡¶Æ‡ßå‡¶ú‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ PDF ‡¶è‡¶¨‡¶Ç JPG ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡•§</p>
            </div>
            <div class="bg-gradient-to-br from-purple-100 to-pink-100 p-6 rounded-lg shadow-md text-center hover:bg-gradient-to-tl hover:from-purple-200 hover:to-pink-200 transition duration-300">
                <img src="https://via.placeholder.com/50" alt="Search Icon" class="mx-auto mb-4">
                <h3 class="text-xl font-semibold mb-4 text-purple-700">‡¶∏‡¶π‡¶ú ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶®</h3>
                <p class="text-gray-700">‡¶ú‡ßá‡¶≤‡¶æ, ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶Æ‡ßå‡¶ú‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®‡•§</p>
            </div>
            <div class="bg-gradient-to-br from-yellow-100 to-orange-100 p-6 rounded-lg shadow-md text-center hover:bg-gradient-to-tl hover:from-yellow-200 hover:to-orange-200 transition duration-300">
                <img src="https://via.placeholder.com/50" alt="Download Icon" class="mx-auto mb-4">
                <h3 class="text-xl font-semibold mb-4 text-yellow-700">‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°</h3>
                <p class="text-gray-700">‡¶è‡¶ï ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-indigo-800 to-purple-800 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-yellow-200">‡¶á-‡¶Æ‡ßå‡¶ú‡¶æ</h3>
                    <p class="text-gray-300">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶Æ‡ßå‡¶ú‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶∏‡¶π‡¶ú ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ‡•§</p>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-yellow-200">‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="hover:text-yellow-100">‡¶π‡ßã‡¶Æ</a></li>
                        <li><a href="services.html" class="hover:text-yellow-100">‡¶∏‡ßá‡¶¨‡¶æ</a></li>
                        <li><a href="contact.html" class="hover:text-yellow-100">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-4 text-yellow-200">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h3>
                    <p class="text-gray-300">‡¶á‡¶Æ‡ßá‡¶á‡¶≤: info@emouza.com</p>
                    <p class="text-gray-300">‡¶´‡ßã‡¶®: +‡ßÆ‡ßÆ‡ß¶ ‡ßß‡ß®‡ß©‡ß™-‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ‡ß¶</p>
                </div>
            </div>
            <div class="text-center mt-8">
                <p class="text-gray-300">¬© ‡ß®‡ß¶‡ß®‡ß´ ‡¶á-‡¶Æ‡ßå‡¶ú‡¶æ‡•§ ‡¶∏‡¶∞‡ßç‡¶¨‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§‡•§</p>
            </div>
        </div>
    </footer>

    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal" onclick="closeModal(event)">
        <div class="auth-content" onclick="event.stopPropagation()">
            <h3 class="text-xl font-bold mb-4 text-green-700">‡¶Ü‡¶á‡¶°‡¶ø ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá, ‡¶π‡ßã‡¶Ø‡¶º‡¶æ‡¶ü‡¶∏‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
            <input type="text" id="otpCode" placeholder="‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" class="w-full px-4 py-2 mb-4 rounded-md border border-gray-300" required>
            <button onclick="confirmOTP()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md w-full">‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ</button>
            <p id="authStatus" class="mt-4"></p>
            <div class="mt-4">
                <span class="whatsapp-icon" onclick="openWhatsApp()">üì±</span>
            </div>
        </div>
    </div>

    <script>
        let mapDatabase = {};
        let isDataLoaded = false;
        let selectedMap = null;
        let usedOTPs = new Set(); // ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ OTP ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï

        // WebSocket ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó
        const ws = new WebSocket('ws://localhost:8080');
        ws.onopen = () => console.log('Connected to WebSocket');
        ws.onmessage = (event) => {
            const data = JSON.parse(event.data);
            if (data.type === 'otp_generated') {
                console.log('Received OTP:', data.otp);
            } else if (data.type === 'otp_verified' && data.success) {
                document.getElementById('authStatus').textContent = '‡¶ï‡ßã‡¶° ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶∏‡¶´‡¶≤! ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®‡•§';
                document.getElementById('authStatus').classList.add('confirmed');
                displayDownloadOptions();
                document.getElementById('authModal').style.display = 'none';
                usedOTPs.add(document.getElementById('otpCode').value); // OTP ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶ö‡¶ø‡¶π‡ßç‡¶®‡¶ø‡¶§
            } else if (data.type === 'otp_verified' && !data.success) {
                document.getElementById('authStatus').textContent = '‡¶Ö‡¶¨‡ßà‡¶ß ‡¶¨‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡ßÉ‡¶§ ‡¶ï‡ßã‡¶°!';
                document.getElementById('authStatus').classList.add('pending');
            }
        };
        ws.onerror = (error) => console.error('WebSocket error:', error);
        ws.onclose = () => console.log('WebSocket disconnected');

        // ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        async function loadMapDatabase() {
            if (!isDataLoaded) {
                try {
                    const response = await fetch('https://raw.githubusercontent.com/enoksha/emouza/main/maps.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);
                    }
                    mapDatabase = await response.json();
                    isDataLoaded = true;
                    console.log('maps.json data loaded:', mapDatabase);
                } catch (error) {
                    console.error('Error loading map database:', error);
                    alert('‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶á‡¶∏ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§\n‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ' + error.message);
                }
            }
        }

        // ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶≤‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶°
        window.onload = loadMapDatabase;

        function searchMap() {
            const district = document.getElementById('district').value.toLowerCase();
            const upazila = document.getElementById('upazila').value.toLowerCase();
            const mouza = document.getElementById('mouza').value.trim().toLowerCase();

            if (!district || !upazila || !mouza) {
                alert('‡¶¶‡ßü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ú‡ßá‡¶≤‡¶æ, ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶Æ‡ßå‡¶ú‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
                return;
            }

            if (!isDataLoaded) {
                alert('‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá, ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
                loadMapDatabase();
                return;
            }

            console.log('Searching for:', district, upazila, mouza);
            if (mapDatabase[district] && mapDatabase[district][upazila] && mapDatabase[district][upazila][mouza]) {
                selectedMap = mapDatabase[district][upazila][mouza];
                showAuthModal();
            } else {
                alert(`‡¶ï‡ßã‡¶®‡ßã ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø: ${district}, ${upazila}, ${mouza}`);
            }
        }

        function showAuthModal() {
            document.getElementById('authStatus').textContent = '';
            document.getElementById('otpCode').value = '';
            const modal = document.getElementById('authModal');
            modal.style.display = 'flex';
        }

        function closeModal(event) {
            if (event.target.id === 'authModal') {
                document.getElementById('authModal').style.display = 'none';
            }
        }

        function openWhatsApp() {
            const phoneNumber = '8801712345678'; // ‡¶è‡¶°‡¶Æ‡¶ø‡¶®‡ßá‡¶∞ WhatsApp ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞
            const message = '‡¶Ü‡¶Æ‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡•§ ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ï‡ßã‡¶° ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§';
            const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function confirmOTP() {
            const otp = document.getElementById('otpCode').value.trim();
            if (!otp) {
                document.getElementById('authStatus').textContent = '‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!';
                return;
            }
            ws.send(JSON.stringify({ type: 'verify_otp', otp }));
        }

        function displayDownloadOptions() {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'container mx-auto px-4 mt-4 text-center';

            if (selectedMap.pdf) {
                const pdfInfo = `
                    <div class="file-info">
                        <p><strong>‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ:</strong> ${selectedMap.file_name}</p>
                        <p><strong>‡¶ú‡ßá‡¶≤ ‡¶®‡¶Ç:</strong> ${selectedMap.district_no}</p>
                        <p><strong>‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú:</strong> ${selectedMap.file_size}</p>
                        <a href="${selectedMap.pdf}" download class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md mt-2 inline-block">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° (PDF)</a>
                    </div>
                `;
                resultDiv.innerHTML += pdfInfo;
            }

            if (selectedMap.jpg) {
                const jpgInfo = `
                    <div class="file-info">
                        <p><strong>‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ:</strong> ${selectedMap.file_name}</p>
                        <p><strong>‡¶ú‡ßá‡¶≤ ‡¶®‡¶Ç:</strong> ${selectedMap.district_no}</p>
                        <p><strong>‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú:</strong> ${selectedMap.file_size}</p>
                        <a href="${selectedMap.jpg}" download class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md mt-2 inline-block">‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° (JPG)</a>
                    </div>
                `;
                resultDiv.innerHTML += jpgInfo;
            }

            document.querySelector('.hero-bg').appendChild(resultDiv);
        }
    </script>
</body>
</html>
